{% extends 'qstockapp/base.html' %}
{% load static %}

<!-- head  -->
{% block head %}
<link rel="stylesheet" href="{% static 'css/quickstockapp/form.css' %}">
<title>Gestion des ventes</title>
{% endblock %}

<!-- extra styles  -->
{% block extra_styles %} 

{% endblock %}

<!-- body content -->
{% block body %}
<h3>Modifier une vente</h3>
<form method="POST">
    {% csrf_token %} 
    <div class="form-content">
        
        <div>
            {{ form.sale_date.label_tag }}
            {% include 'qstockapp/date_input.html' %}
            {{ form.sale_date.as_hidden }}
            {% for error in form.sale_date.errors %}
            <p class="error">{{ error }}</p>
            {% endfor %}
            {% include 'qstockapp/date_input_binding.html' %}
        </div>
        <div>
            {{ form.product.label_tag }}
            {{ form.product }}
        </div>
        <div>
            {{ form.store.label_tag }}
            {{ form.store }}
        </div>
        <div>
            {{ form.quantity.label_tag }}
            {{ form.quantity }}
            {% for e in form.quantity.errors %}
                <p class="error">{{ e }}</p>
            {% endfor %}
        </div>
        <div>
            {{ form.buyer_name.label_tag }}
            {{ form.buyer_name }}
        </div>
        <div>
            {{ form.buyer_phone.label_tag }}
            {{ form.buyer_phone }}
        </div>
        {% if sale.discount_applied %}
        <div id="discount_field_applied">
            {{ form.discount.label_tag }}
            <p class="help_text" style="font-size: .8rem;">Modifier le montant de la réduction</p>
            {{ form.discount }}
        </div>
        {% else %}
        <div id="discount_field">
            {{ form.discount.label_tag }}
            {{ form.discount }}
        </div>
        <a href="#" class="link primary" id="discount_apply_btn">Appliquer une réduction</a>
        {% endif %}
    </div>
    <script>
        const discountField = document.getElementById("discount_field");
        discountField.style.display = "none";
        const discountBtn = document.getElementById("discount_apply_btn")
        discountBtn.addEventListener("click", () => {
            discountField.style.display = "inline-block";
            discountBtn.remove();
        })
    </script>
    <button type="submit">Modifier</button>
    <a class="link" href="{% url 'sales:sale_details' pk=sale.pk %}">Annuler</a>
</form>
{% endblock %}

